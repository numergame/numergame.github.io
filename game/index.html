<!doctype html>
<html>

<head>
    <title data-i18n="play-title"></title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <link href='https://fonts.googleapis.com/css?family=Roboto+Mono' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="open-iconic/font/css/open-iconic.css" rel="stylesheet">

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="img/favicon.ico" rel="icon">
    <link href="css/styles.css" rel="stylesheet" type="text/css">
    <script src="html/soundmanager2-setup.js"></script>
    <script src="html/soundmanager2-nodebug-jsmin.js"></script>
    <script src="bowser/2.7.0/bowser.min.js"></script>
    <script>
        function getBrowser() {
            var result = bowser.getParser(window.navigator.userAgent);
            return result.parsedResult.browser.name;
        }

        function getBrowserDevice() {
            var result = bowser.getParser(window.navigator.userAgent);
            return result.parsedResult.platform.type;
        }
    </script>
</head>

<body id="body">

<div id="header" class="d-none container">
    <div class="row align-items-center">
        <div class="col-md">
            <h6></h6>
            <h6 class="text-center">
                <a href="/">Numer</a> <span data-i18n="is-available-for"></span> 
                <a href="#Appstore">iOS</a> <span data-i18n="and"></span> 
                <a href="#GooglePlay">Android</a>
            </h6>
            <h6></h6>
        </div>
    </div>
</div>

<div id="embed-html" class="d-none"></div>
<div id="loaderModal" class="modal" style="background-color: #ffffff;">
    <div id="loader" class="hidden justify-content-center d-flex">
        <div class="spinner-border" role="status" style="margin-top: auto; margin-bottom: auto;">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
</div>

<div id="footer" class="d-none container">
    <div class="row align-items-center">
        <div class="col-md text-center">
            <button id="infoBtn" type="button" class="btn btn-default" data-toggle="modal" data-target="#infoModal">
                <span class="oi" data-glyph="info" title="info" aria-hidden="true"></span>
            </button>
            <button id="refreshBtn" type="button" class="btn btn-default">
                <span class="oi" data-glyph="reload" title="reload" aria-hidden="true"></span>
            </button>
            <button id="volumeBtn" type="button" class="btn btn-default" data-toggle="popover" data-trigger="focus" title="Dismissible popover" data-content="And here's some amazing content. It's very engaging. Right?">
                <span class="oi" data-glyph="volume-high" title="volume" aria-hidden="true"></span>
            </button>
            <span class="d-inline-block">
                <button id="volumeBtnDisabled" style="pointer-events: none;" type="button" class="d-none btn btn-default" disabled>
                    <span class="oi" data-glyph="volume-off" title="volume" aria-hidden="true"></span>
                </button>
            </span>
        </div>
    </div>
    <div class="row">
        <h3 class="col-md"></h3>
    </div>

    <script type="text/javascript" src="html/html.nocache.js"></script>
</div>

<!-- Modal -->
<div class="modal fade" id="successModal" tabindex="-1" role="dialog" aria-labelledby="successModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 data-i18n="success" class="modal-title" id="successModalTitle">Title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p data-i18n="success-text" id="successModalText">Congratulations! You have solved the puzzle successfully! If you want to share solution you can copy the link above:</p>
                <input id="successModalInput" onfocus="this.select();" type="text" class="form-control" id="recipient-name">
            </div>
            <div class="modal-footer">
                <button data-i18n="close" id="successModalCloseBtn" type="button" class="btn btn-secondary" data-dismiss="modal"></button>
                <button data-i18n="copy" id="successModalCopyBtn" type="button" class="btn btn-primary copy-btn" data-clipboard-target="#successModalInput"></button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="noMovesModal" tabindex="-1" role="dialog" aria-labelledby="noMovesModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 data-i18n="no-moves" class="modal-title" id="noMovesModalTitle">Title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p data-i18n="no-moves-text" id="noMovesModalText">Congratulations! You have solved the puzzle successfully! If you want to share solution you can copy the link above:</p>
            </div>
            <div class="modal-footer">
                <button data-i18n="close" id="noMovesModalCloseBtn" type="button" class="btn btn-secondary" data-dismiss="modal"></button>
                <button data-i18n="refresh" id="noMovesModalRefreshBtn" type="button" class="btn btn-primary"></button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="notMaxModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <p data-i18n="not-max-text"></p>
                <p data-i18n="learn-how-to-play"></p>
            </div>
            <div class="modal-footer">
                <button data-i18n="close" id="notMaxModalCloseBtn" type="button" class="btn btn-secondary" data-dismiss="modal"></button>
                <button data-i18n="how-to-play" id="notMaxModalHowToPlayBtn" type="button" class="btn btn-primary"></button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="infoModal" tabindex="-1" role="dialog" aria-labelledby="infoModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 data-i18n="how-to-play" class="modal-title" id="infoModalTitle"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="infoModalText">
                <p data-i18n="how-to-play-text-1"></p>
                <p data-i18n="how-to-play-text-2"></p>
                <p class="font-weight-bold" data-i18n="movements"></p>
                <p data-i18n="how-to-play-text-3"></p>
                <div class="container">
                    <div class="row">
                        <div class="d-inline-block sample">
                            <img src="img/sample-01-01.svg" class="img-fluid" />
                        </div>
                    </div>
                </div>
                <p data-i18n="how-to-play-text-4"></p>
                <div class="container">
                    <div class="row">
                        <div class="sample">
                            <img src="img/sample-02-01.svg" class="img-fluid" />
                        </div>
                    </div>
                </div>
                <p data-i18n="how-to-play-text-5"></p>
                <div class="container">
                    <div class="row">
                        <div class="sample">
                            <img src="img/sample-03-01.svg" class="img-fluid" />
                        </div>
                    </div>
                </div>
                <p data-i18n="how-to-play-text-6"></p>
                <p class="font-weight-bold" data-i18n="invalid-movements"></p>
                <p data-i18n="how-to-play-text-7"></p>
                <div class="container">
                    <div class="row">
                        <div class="d-inline-block">
                            <div class="sample">
                                <img src="img/sample-04-01.svg" class="img-fluid" />
                            </div>
                        </div>
                        <div class="d-inline-block">
                            <div class="sample">
                                <img src="img/sample-04-02.svg" class="img-fluid" />
                            </div>
                        </div>
                    </div>
                </div>
                <p data-i18n="how-to-play-text-8"></p>
                <p data-i18n="how-to-play-text-9"></p>
                <div class="container">
                    <div class="row">
                        <div class="d-inline-block">
                            <div class="sample short-sample">
                                <img src="img/sample-05-01.svg" class="img-fluid" />
                            </div>
                        </div>
                        <div class="d-inline-block">
                            <div class="sample short-sample">
                                <img src="img/sample-05-02.svg" class="img-fluid" />
                            </div>
                        </div>
                        <div class="d-inline-block">
                            <div class="sample short-sample">
                                <img src="img/sample-05-03.svg" class="img-fluid" />
                            </div>
                        </div>
                    </div>
                </div>
                <p data-i18n="how-to-play-text-10"></p>
                <div class="container">
                    <div class="row">
                        <div class="sample short-sample">
                            <img src="img/sample-06-01.svg" class="img-fluid" />
                        </div>
                    </div>
                </div>
                <hr/>
                <p data-i18n="how-to-play-text-11"></p>
            </div>
            <div class="modal-footer">
                <button data-i18n="close" id="infoModalCloseBtn" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="messageModal" tabindex="-1" role="dialog" aria-labelledby="messageModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 data-i18n="invalid-link" class="modal-title" id="messageModalTitle"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div data-i18n="invalid-link-text" class="modal-body" id="messageModalText">
            </div>
            <div class="modal-footer">
                <button data-i18n="close" id="messageModalCloseBtn" type="button" class="btn btn-secondary" data-dismiss="modal"></button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/clipboard.min.js"></script>

<script type="text/javascript" src="js/localization/localization.js"></script>

<script type="text/javascript" src="js/localization/jquery.i18n.js"></script>
<script type="text/javascript" src="js/localization/jquery.i18n.messagestore.js"></script>
<script type="text/javascript" src="js/localization/jquery.i18n.fallbacks.js"></script>
<script type="text/javascript" src="js/localization/jquery.i18n.parser.js"></script>
<script type="text/javascript" src="js/localization/jquery.i18n.emitter.js"></script>
<script type="text/javascript" src="js/localization/jquery.i18n.language.js"></script>
<script type="text/javascript" src="js/localization/languages/ru.js"></script>

</body>

<script>
    var isLocalized = false;
    
    document.addEventListener('visibilitychange', function() {
        handleResize();
    });
    
    $(document).ready(function() {
        'use strict';

        $(window).resize(function (e) {
            handleResize();
        });
        
        window.addEventListener("orientationchange", function() {
            handleResize();
        }, false);

        showLoader();

        $('#volumeBtn').prop('disabled', true);

        initI18n('./js/localization/', function() {
            isLocalized = true;
        });

        var browser = getBrowser();
        if (browser === "Internet Explorer" || browser === "Microsoft Edge") {
            $(".modal-content").addClass("fix-ie");
        }

        document.getElementById('embed-html').addEventListener('mousedown', handleMouseDown, false);
        document.getElementById('embed-html').addEventListener('mouseup', handleMouseUp, false);
        
        new ClipboardJS('.copy-btn');

        $('#refreshBtn').click(function (e) {
            raiseRefresh();
        });
        
        $('#noMovesModalRefreshBtn').click(function (e) {
            raiseRefresh();
            $("#noMovesModal").modal("hide");
        });

        $('#notMaxModalHowToPlayBtn').click(function (e) {
            $("#notMaxModal").modal("hide");
            $('#notMaxModal').on('hidden.bs.modal', function (e) {
                $("#infoModal").modal("show");
                $(this).off("hidden.bs.modal");
            });
        });

        $('#volumeBtn').click(function (e) {
            var attrName = 'data-glyph';
            var span = $(this).find('span')[0];
            var dataGlyph = span.getAttribute(attrName);
            var offValue = 'volume-off';
            var onValue = 'volume-high';
            if (dataGlyph === onValue) {
                enableSound(false);
                dataGlyph = offValue;
            } else if (dataGlyph === offValue) {
                enableSound(true);
                dataGlyph = onValue;
            }
            span.setAttribute(attrName, dataGlyph);
        });
    });
    
    function showLoader() {
        var loader = document.getElementById("loader");
        var header = document.getElementById("header");
        var game = document.getElementById("embed-html");
        var footer = document.getElementById("footer");
        loader.style.height = window.innerHeight + 'px';
        $("#loaderModal").modal("show");
        $(header).removeClass("d-none");
        $(game).removeClass("d-none");
        $(footer).removeClass("d-none");
    }

    function hideLoader() {
        if (isLocalized === true) {
            $("#loaderModal").modal("hide");
            handleResize();
        } else {
            setTimeout(function() {
                hideLoader();
            }, 100);
        }
    }

    function handleMouseDown(evt) {
        evt.preventDefault();
        evt.stopPropagation();
        evt.target.style.cursor = 'default';
    }

    function handleMouseUp(evt) {
        evt.preventDefault();
        evt.stopPropagation();
        evt.target.style.cursor = '';
    }

    function getHeaderHeight() {
        return document.getElementById("header").offsetHeight;
    }

    function getFooterHeight() {
        return document.getElementById("footer").offsetHeight;
    }

    function getCanvasWidth() {
        return window.innerWidth;
    }

    function getCanvasHeight() {
        return window.innerHeight - getHeaderHeight() - getFooterHeight();
    }

    function showSuccessModal(link) {
        var input = document.getElementById("successModalInput");
        input.value = link;
        $("#successModal").modal("show");
    }

    function showNoMovesModal() {
        $("#noMovesModal").modal("show");
    }

    function showNotMaxModal() {
        $("#notMaxModal").modal("show");
    }

    function showInvalidLinkModal() {
        $("#messageModal").modal("show");
    }

    function actualizeSound(supported, enabled) {
        var span = $('#volumeBtn').find('span')[0];
        var value = 'volume-off';
        if (supported === false) {
            $('#volumeBtn').prop('disabled', true).addClass("d-none");
            $('#volumeBtnDisabled').removeClass("d-none").addClass("d-inline-block");
        } else {
            $('#volumeBtn').prop('disabled', false);
            if (enabled === true) {
                value = 'volume-high';
            }
        }
        span.setAttribute('data-glyph', value);
    }
</script>

</html>